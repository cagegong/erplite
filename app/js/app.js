// Generated by CoffeeScript 1.7.1
(function() {
  var erpApp;

  erpApp = angular.module('erpApp', ['ngRoute', 'erpAnimations', 'erpDirectives', 'erpControllers', 'erpServices', 'erpFilters', 'contactModule', 'ui.bootstrap']);

  erpApp.constant('erpSettings', {
    apiHost: 'http://localhost:8000'
  });

  erpApp.config([
    '$routeProvider', function($routeProvider) {
      return $routeProvider.when('/home', {
        templateUrl: 'views/home.html',
        controller: 'HomeCtrl'
      }).when('/contact', {
        templateUrl: 'Contact/views/contactlist.html',
        controller: 'ContactListCtrl'
      }).when('/contact/new', {
        templateUrl: 'Contact/views/contactdetail.html',
        controller: 'NewContactCtrl'
      }).when('/contact/:id', {
        templateUrl: 'Contact/views/contactdetail.html',
        controller: 'ContactDetailCtrl'
      }).when('/login', {
        templateUrl: 'views/login.html',
        controller: 'LoginCtrl'
      }).when('/logout', {
        templateUrl: 'views/login.html',
        controller: 'LoginCtrl'
      }).when('/login/:query', {
        templateUrl: 'views/login.html',
        controller: 'LoginCtrl'
      }).when('/signup', {
        templateUrl: 'views/signup.html',
        controller: 'SignupCtrl'
      }).when('/404', {
        templateUrl: 'views/404.html',
        controller: '404Ctrl'
      }).otherwise({
        redirectTo: '/home'
      });
    }
  ]);

  erpApp.run([
    '$rootScope', '$location', '$log', '$http', 'erpSettings', function($rootScope, $location, $log, $http, erpSettings) {
      $http.get(erpSettings.apiHost).success(function(data) {
        return $rootScope.apimap = data;
      }).error(function(error) {
        return $log.log(error);
      });
      $rootScope.$on('$routeChangeSuccess', function(event, next, current) {});
      return $rootScope.$on('errorHappened', function(event, status, next) {
        switch (status) {
          case '401':
            return $location.url("/login?path=" + next);
          case '404':
            return $location.url("/404");
        }
      });
    }
  ]);

}).call(this);
