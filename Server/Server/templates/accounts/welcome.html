<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN""http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
    <title>Welcome!</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
        function generate(name) {
            $.get('generate',{name: name}, function (data) {
                $("#code").text(data)
            });
        }
    </script>
</head>
<body>
    <h2>{{w}}</h2>
    <hr/>
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}

    <p>{% if request.user.is_authenticated %}
        {% if not token %}
     <input type="button" value="Generate your API Code" onclick="generate('{{name}}')">
     <br>
     {% endif %}
     <label>Code:</label>
     <label id="code">{{ token }}</label>
    {% endif %}
    </p>

    <p>{% if request.user.is_authenticated %}
     <a href="{%url logout%}">注销</a> 
    {% else %}<a href="{%url login%}">登陆</a>  |  
    <a href="{%url register%}">注册</a>   
    {% endif %}
    </p>
</body>
</html>
